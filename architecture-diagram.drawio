<mxfile host="app.diagrams.net" modified="2026-02-02T18:00:00.000Z" agent="Claude" version="21.0.0" type="device">
  <diagram id="litellm-aws-architecture" name="LiteLLM AWS Architecture">
    <mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="title" value="LiteLLM AWS Infrastructure Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1;fontColor=#232F3E;" vertex="1" parent="1">
          <mxGeometry x="450" y="20" width="500" height="40" as="geometry"/>
        </mxCell>

        <!-- Azure DevOps -->
        <mxCell id="ado-group" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0078D4;fontColor=#ffffff;strokeColor=#0078D4;opacity=10;arcSize=5;" vertex="1" parent="1">
          <mxGeometry x="470" y="70" width="460" height="80" as="geometry"/>
        </mxCell>
        <mxCell id="ado-label" value="Azure DevOps Pipelines" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;fontSize=12;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="580" y="72" width="240" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="ado-security" value="Security&#xa;Pipeline" style="shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.general_AWS_cloud;fillColor=#0078D4;fontColor=#FFFFFF;fontStyle=0;fontSize=9;strokeColor=none;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="490" y="95" width="40" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="ado-network" value="Network&#xa;Pipeline" style="shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.general_AWS_cloud;fillColor=#0078D4;fontColor=#FFFFFF;fontStyle=0;fontSize=9;strokeColor=none;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="550" y="95" width="40" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="ado-alb" value="ALB&#xa;Pipeline" style="shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.general_AWS_cloud;fillColor=#0078D4;fontColor=#FFFFFF;fontStyle=0;fontSize=9;strokeColor=none;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="610" y="95" width="40" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="ado-database" value="Database&#xa;Pipeline" style="shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.general_AWS_cloud;fillColor=#0078D4;fontColor=#FFFFFF;fontStyle=0;fontSize=9;strokeColor=none;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="670" y="95" width="40" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="ado-litellm" value="LiteLLM&#xa;Pipeline" style="shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.general_AWS_cloud;fillColor=#0078D4;fontColor=#FFFFFF;fontStyle=0;fontSize=9;strokeColor=none;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="730" y="95" width="40" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="ado-teardown" value="Teardown&#xa;Pipeline" style="shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.general_AWS_cloud;fillColor=#DD3522;fontColor=#FFFFFF;fontStyle=0;fontSize=9;strokeColor=none;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="800" y="95" width="40" height="40" as="geometry"/>
        </mxCell>

        <!-- Arrow from ADO to AWS -->
        <mxCell id="ado-to-aws" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;exitX=0.5;exitY=1;entryX=0.5;entryY=0;strokeColor=#232F3E;strokeWidth=2;dashed=1;" edge="1" parent="1" source="ado-group" target="aws-cloud">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="ado-arrow-label" value="CloudFormation&#xa;Deploy" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#666666;" vertex="1" connectable="0" parent="ado-to-aws">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

        <!-- AWS Cloud boundary -->
        <mxCell id="aws-cloud" value="" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_aws_cloud_alt;stroke=1;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#AAB7B8;dashed=0;strokeColor=#232F3E;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="40" y="190" width="1320" height="960" as="geometry"/>
        </mxCell>
        <mxCell id="aws-label" value="AWS Cloud (us-east-1)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=14;fontStyle=1;fontColor=#232F3E;" vertex="1" parent="1">
          <mxGeometry x="70" y="195" width="200" height="25" as="geometry"/>
        </mxCell>

        <!-- Security Stack (outside VPC) -->
        <mxCell id="security-group" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;arcSize=5;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="230" width="230" height="440" as="geometry"/>
        </mxCell>
        <mxCell id="security-label" value="Security Stack" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;fontSize=13;fontStyle=1;fontColor=#D6B656;" vertex="1" parent="1">
          <mxGeometry x="110" y="235" width="130" height="20" as="geometry"/>
        </mxCell>

        <!-- KMS -->
        <mxCell id="kms" value="KMS&#xa;Encryption Key" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;gradientColor=#F54749;gradientDirection=north;fillColor=#BF0816;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=10;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.kms;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="150" y="265" width="48" height="48" as="geometry"/>
        </mxCell>

        <!-- Secrets Manager -->
        <mxCell id="secrets-group" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FCE4EC;strokeColor=#E57373;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="75" y="330" width="200" height="195" as="geometry"/>
        </mxCell>
        <mxCell id="secrets-label" value="Secrets Manager" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="115" y="333" width="120" height="18" as="geometry"/>
        </mxCell>
        <mxCell id="secret-master" value="master-key&#xa;(API Auth)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#BF0816;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.secret;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="92" y="358" width="33" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="secret-ui" value="ui-password&#xa;(Admin UI)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#BF0816;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.secret;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="159" y="358" width="33" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="secret-api" value="api-keys&#xa;(LLM Keys)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#BF0816;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.secret;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="226" y="358" width="33" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="secret-db" value="database&#xa;(PostgreSQL)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#BF0816;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.secret;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="92" y="445" width="33" height="40" as="geometry"/>
        </mxCell>

        <!-- IAM Roles -->
        <mxCell id="iam-exec" value="ECS Execution&#xa;Role" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#BF0816;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.role;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="95" y="560" width="40" height="23" as="geometry"/>
        </mxCell>
        <mxCell id="iam-task" value="ECS Task&#xa;Role" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#BF0816;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.role;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="200" y="560" width="40" height="23" as="geometry"/>
        </mxCell>

        <!-- Lambda Rotation -->
        <mxCell id="lambda-rotation" value="Secret&#xa;Rotation&#xa;Lambda" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.lambda;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="155" y="445" width="40" height="40" as="geometry"/>
        </mxCell>

        <!-- VPC -->
        <mxCell id="vpc" value="" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_vpc2;stroke=1;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#879196;dashed=0;strokeColor=#8C4FFF;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="310" y="230" width="1030" height="900" as="geometry"/>
        </mxCell>
        <mxCell id="vpc-label" value="VPC 10.0.0.0/16" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=13;fontStyle=1;fontColor=#8C4FFF;" vertex="1" parent="1">
          <mxGeometry x="350" y="235" width="150" height="20" as="geometry"/>
        </mxCell>

        <!-- Internet Gateway -->
        <mxCell id="igw" value="Internet&#xa;Gateway" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=10;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.internet_gateway;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="680" y="245" width="40" height="40" as="geometry"/>
        </mxCell>

        <!-- Public Subnets -->
        <mxCell id="public-sub1" value="" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#7AA116;fillColor=#F2F6E8;verticalAlign=top;align=left;spacingLeft=30;fontColor=#248814;dashed=0;" vertex="1" parent="1">
          <mxGeometry x="340" y="300" width="310" height="180" as="geometry"/>
        </mxCell>
        <mxCell id="pub-sub1-label" value="Public Subnet 1 (AZ-a)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=11;fontStyle=1;fontColor=#248814;" vertex="1" parent="1">
          <mxGeometry x="380" y="305" width="200" height="18" as="geometry"/>
        </mxCell>

        <mxCell id="public-sub2" value="" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#7AA116;fillColor=#F2F6E8;verticalAlign=top;align=left;spacingLeft=30;fontColor=#248814;dashed=0;" vertex="1" parent="1">
          <mxGeometry x="680" y="300" width="310" height="180" as="geometry"/>
        </mxCell>
        <mxCell id="pub-sub2-label" value="Public Subnet 2 (AZ-b)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=11;fontStyle=1;fontColor=#248814;" vertex="1" parent="1">
          <mxGeometry x="720" y="305" width="200" height="18" as="geometry"/>
        </mxCell>

        <!-- ALB -->
        <mxCell id="alb" value="Application&#xa;Load Balancer&#xa;(:80 / :443)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=10;fontStyle=1;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.application_load_balancer;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="560" y="340" width="48" height="48" as="geometry"/>
        </mxCell>

        <!-- NAT Gateway -->
        <mxCell id="nat" value="NAT&#xa;Gateway" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=10;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.nat_gateway;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="400" y="370" width="40" height="40" as="geometry"/>
        </mxCell>

        <!-- Private Subnets -->
        <mxCell id="private-sub1" value="" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#00A4A6;fillColor=#E6F6F7;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;dashed=0;" vertex="1" parent="1">
          <mxGeometry x="340" y="520" width="470" height="350" as="geometry"/>
        </mxCell>
        <mxCell id="priv-sub1-label" value="Private Subnet 1 (AZ-a)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=11;fontStyle=1;fontColor=#147EBA;" vertex="1" parent="1">
          <mxGeometry x="380" y="525" width="200" height="18" as="geometry"/>
        </mxCell>

        <mxCell id="private-sub2" value="" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#00A4A6;fillColor=#E6F6F7;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;dashed=0;" vertex="1" parent="1">
          <mxGeometry x="840" y="520" width="470" height="350" as="geometry"/>
        </mxCell>
        <mxCell id="priv-sub2-label" value="Private Subnet 2 (AZ-b)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=11;fontStyle=1;fontColor=#147EBA;" vertex="1" parent="1">
          <mxGeometry x="880" y="525" width="200" height="18" as="geometry"/>
        </mxCell>

        <!-- ECS Cluster -->
        <mxCell id="ecs-cluster" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FDEBD0;strokeColor=#F0B27A;arcSize=5;" vertex="1" parent="1">
          <mxGeometry x="370" y="560" width="240" height="200" as="geometry"/>
        </mxCell>
        <mxCell id="ecs-label" value="ECS Cluster (Fargate)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;fontSize=11;fontStyle=1;fontColor=#E67E22;" vertex="1" parent="1">
          <mxGeometry x="400" y="563" width="180" height="18" as="geometry"/>
        </mxCell>

        <!-- ECS Task -->
        <mxCell id="ecs-task" value="LiteLLM Proxy&#xa;Container&#xa;(:4000)&#xa;&#xa;0.5 vCPU / 1GB&#xa;&#xa;/health/liveliness&#xa;/v1/* (API)&#xa;/ui (Admin)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=middle;verticalAlign=middle;align=left;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.ecs_task;labelPosition=right;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="395" y="600" width="37" height="48" as="geometry"/>
        </mxCell>

        <!-- Auto Scaling indicator -->
        <mxCell id="autoscale" value="Auto-Scaling&#xa;Min: 1 / Max: 4&#xa;CPU: 70% / Mem: 80%" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=8;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.auto_scaling2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="395" y="700" width="37" height="37" as="geometry"/>
        </mxCell>

        <!-- RDS in Private Subnet 1 -->
        <mxCell id="rds" value="RDS PostgreSQL 15&#xa;db.t3.micro&#xa;20-100 GB gp3&#xa;KMS Encrypted&#xa;7-day backup" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.rds;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="700" y="620" width="48" height="48" as="geometry"/>
        </mxCell>

        <!-- RDS Standby in Private Subnet 2 -->
        <mxCell id="rds-standby" value="RDS Standby&#xa;(Multi-AZ&#xa;Prod Only)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=9;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.rds;opacity=40;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="960" y="620" width="48" height="48" as="geometry"/>
        </mxCell>

        <!-- VPC Endpoints -->
        <mxCell id="vpce-group" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EDE7F6;strokeColor=#9575CD;arcSize=8;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="860" y="730" width="430" height="110" as="geometry"/>
        </mxCell>
        <mxCell id="vpce-label" value="VPC Endpoints (Interface)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;fontSize=10;fontStyle=1;fontColor=#7E57C2;" vertex="1" parent="1">
          <mxGeometry x="970" y="733" width="200" height="16" as="geometry"/>
        </mxCell>
        <mxCell id="vpce-ecr" value="ECR&#xa;API + DKR" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=8;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.endpoint;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="885" y="755" width="33" height="33" as="geometry"/>
        </mxCell>
        <mxCell id="vpce-s3" value="S3&#xa;(Gateway)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=8;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.endpoint;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="960" y="755" width="33" height="33" as="geometry"/>
        </mxCell>
        <mxCell id="vpce-secrets" value="Secrets&#xa;Manager" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=8;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.endpoint;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1035" y="755" width="33" height="33" as="geometry"/>
        </mxCell>
        <mxCell id="vpce-logs" value="CloudWatch&#xa;Logs" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#8C4FFF;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=8;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.endpoint;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1110" y="755" width="33" height="33" as="geometry"/>
        </mxCell>

        <!-- External Services -->
        <mxCell id="ecr" value="ECR&#xa;Registry" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=10;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.ecr;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1100" y="240" width="40" height="40" as="geometry"/>
        </mxCell>

        <mxCell id="cloudwatch" value="CloudWatch&#xa;Logs + Alarms" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#E7157B;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=10;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.cloudwatch_2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1210" y="240" width="40" height="40" as="geometry"/>
        </mxCell>

        <!-- Internet / Users -->
        <mxCell id="users" value="API Clients&#xa;&amp; Admin Users" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#232F3E;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=10;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.users;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="567" y="190" width="35" height="35" as="geometry"/>
        </mxCell>

        <!-- Connections -->
        <!-- Users to ALB -->
        <mxCell id="users-to-alb" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;strokeColor=#232F3E;strokeWidth=2;" edge="1" parent="1" source="users" target="alb">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="users-alb-label" value="HTTPS/HTTP" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#666666;" vertex="1" connectable="0" parent="users-to-alb">
          <mxGeometry x="0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

        <!-- ALB to ECS -->
        <mxCell id="alb-to-ecs" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;strokeColor=#ED7100;strokeWidth=2;" edge="1" parent="1" source="alb" target="ecs-task">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="alb-ecs-label" value=":4000" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#ED7100;fontStyle=1;" vertex="1" connectable="0" parent="alb-to-ecs">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

        <!-- ECS to RDS -->
        <mxCell id="ecs-to-rds" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;strokeColor=#C925D1;strokeWidth=2;" edge="1" parent="1" source="ecs-task" target="rds">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="ecs-rds-label" value=":5432" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#C925D1;fontStyle=1;" vertex="1" connectable="0" parent="ecs-to-rds">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

        <!-- RDS to Standby -->
        <mxCell id="rds-to-standby" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;strokeColor=#C925D1;strokeWidth=1;dashed=1;" edge="1" parent="1" source="rds" target="rds-standby">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="rds-sync-label" value="Sync&#xa;(Multi-AZ)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=8;fontColor=#999999;" vertex="1" connectable="0" parent="rds-to-standby">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

        <!-- Secrets to ECS -->
        <mxCell id="secrets-to-ecs" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;strokeColor=#BF0816;strokeWidth=1;dashed=1;" edge="1" parent="1" source="secrets-group" target="ecs-task">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="175" y="640"/>
              <mxPoint x="350" y="640"/>
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="secrets-ecs-label" value="Inject secrets&#xa;at task start" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=8;fontColor=#BF0816;" vertex="1" connectable="0" parent="secrets-to-ecs">
          <mxGeometry x="-0.3" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

        <!-- Stack Legend -->
        <mxCell id="legend" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#CCCCCC;arcSize=5;" vertex="1" parent="1">
          <mxGeometry x="60" y="920" width="230" height="220" as="geometry"/>
        </mxCell>
        <mxCell id="legend-title" value="Stack Color Legend" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;fontSize=11;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="110" y="925" width="130" height="18" as="geometry"/>
        </mxCell>
        <mxCell id="leg1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;" vertex="1" parent="1">
          <mxGeometry x="75" y="950" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="leg1t" value="1. Security Stack (KMS, Secrets, IAM)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="100" y="947" width="180" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="leg2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#8C4FFF;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="75" y="975" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="leg2t" value="2. Network Stack (VPC, Subnets, SGs)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="100" y="972" width="180" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="leg3" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F2F6E8;strokeColor=#7AA116;" vertex="1" parent="1">
          <mxGeometry x="75" y="1000" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="leg3t" value="3. ALB Stack (Load Balancer, Listeners)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="100" y="997" width="180" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="leg4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#CE93D8;" vertex="1" parent="1">
          <mxGeometry x="75" y="1025" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="leg4t" value="4. Database Stack (RDS PostgreSQL)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="100" y="1022" width="180" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="leg5" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FDEBD0;strokeColor=#F0B27A;" vertex="1" parent="1">
          <mxGeometry x="75" y="1050" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="leg5t" value="5. LiteLLM Stack (ECS, Auto-scaling)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="100" y="1047" width="180" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="leg6" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EDE7F6;strokeColor=#9575CD;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="75" y="1075" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="leg6t" value="VPC Endpoints (private AWS access)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="100" y="1072" width="180" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="leg7" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#E57373;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="75" y="1100" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="leg7t" value="--- Dashed = optional / conditional" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="100" y="1097" width="180" height="20" as="geometry"/>
        </mxCell>

        <!-- Bedrock -->
        <mxCell id="bedrock" value="AWS Bedrock&#xa;(Claude, etc.)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#01A88D;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=10;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.sagemaker;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1210" y="600" width="48" height="48" as="geometry"/>
        </mxCell>

        <!-- ECS to Bedrock -->
        <mxCell id="ecs-to-bedrock" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;strokeColor=#01A88D;strokeWidth=1;dashed=1;" edge="1" parent="1" source="ecs-task" target="bedrock">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="413" y="580"/>
              <mxPoint x="350" y="580"/>
              <mxPoint x="350" y="900"/>
              <mxPoint x="1234" y="900"/>
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bedrock-label" value="InvokeModel&#xa;(via Task Role)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=8;fontColor=#01A88D;" vertex="1" connectable="0" parent="ecs-to-bedrock">
          <mxGeometry x="0.7" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
